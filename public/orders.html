<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Orders</title>

    <!-- ✅ Bootstrap & SweetAlert -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.min.js"></script>
</head>
<body>
    <!-- ✅ Dynamic Header -->
    <div id="header"></div>

    <div class="container mt-4">
        <h3 class="mb-3">My Orders</h3>
        <table class="table table-bordered" id="myOrdersTable">
            <thead class="thead-dark">
                <tr>
                    <th>Order ID</th>
                    <th>Date Placed</th>
                    <th>Date Shipped</th>
                    <th>Date Delivered</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr><td colspan="5" class="text-center">Loading...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        let userId;

        $(document).ready(function () {
            const token = localStorage.getItem("token");
            userId = localStorage.getItem("userId");

            if (!token || !userId) {
                Swal.fire({
                    icon: "warning",
                    text: "You must be logged in first!",
                    showConfirmButton: true,
                }).then(() => {
                    window.location.href = "/login.html";
                });
                return;
            }

            // ✅ Load header (same as home.html)
            $("#header").load("/header.html", function () {
                const headerHeight = $("#header").outerHeight() || 60;
                $("body").css("padding-top", headerHeight + 20 + "px");

                $("#login-link, #register-link").addClass("d-none");
                $("#user-dropdown").removeClass("d-none");

                $.ajax({
                    url: `/api/v1/customers/${userId}`,
                    method: "GET",
                    success: function (res) {
                        if (res.success && res.data) {
                            const data = res.data;
                            const fullName = `${data.fname || ""} ${data.lname || ""}`.trim();
                            $("#username").text(fullName || "USER");
                            if (data.image_path) {
                                $(".profile-img").attr("src", `/${data.image_path}`);
                            }
                        }
                    }
                });
            });
        });
    </script>

    <!-- ✅ Orders logic nasa user.js -->
    <script src="js/user.js"></script>
</body>
</html>
